# Журнал работ

## 2026-01-07
- Печатные формы: HTML "Акт приемки" и "МХ-1" (не Excel) с кнопками в приемке; макеты под образец, постраничное разбиение МХ-1, итоги и подписи, корректный подсчет коробов/палет, добавлен Артикул и скорректированы ширины колонок.
- Акт приемки: название документа приведено к "Акт приемки", добавлены поля и итоговый блок для менеджера/кладовщика/коробов/палет.
- Сотрудники: добавлен раздел "Сотрудники" в кабинете главного менеджера, список и форма редактирования оформлены в стиле кабинета, добавлена кнопка возврата в кабинет.
- Факсимиле: поле факсимиле сотрудников (PNG) с нормализацией размера, превью в списке/форме и подстановка подписи в печатные формы; исправлена раздача `/media/` через права на каталог.
- Карта склада: приложение `stockmap` с доступом кладовщика, таблица зон/рядов/секций/ярусов/ячеек, свободные/занятые; детальный вид ряда основного склада с цветной схемой ячеек (пустые/занятые).

## 2026-01-06
- Настройки сканера: новая страница `/scanner-settings/` с Web Serial (COM), отдельная страница Proton IMS‑2290HD_K с инструкциями и штрихкодами; кнопки добавлены в кабинеты главного менеджера и кладовщика, возврат из настроек ведет в исходный кабинет.
- Приемка товара: добавлен ввод со сканера в акт приемки (карта штрихкод→SKU, автодобавление/суммирование, сообщение о неизвестном ШК); исправлено автосохранение по Enter.
- Акт приемки: разрешено сохранять акт при пустой заявке, если фактические позиции внесены; добавлены фактические количества в журнале и карточке заявки (показываются и для заявок без плана).
- Клиентская номенклатура: в карточках SKU штрихкод показывается как SVG-штрихкод.
- Кабинет клиента: сообщения показывают полное название заявки с номером, блок сообщений со скроллом, увеличен лимит до 30.
- Заказы (клиентский режим): в шапке убраны кнопки «Журнал заявок», «Новая приемка», «Упаковка».
- Приемка (клиент): кнопка «Скачать шаблон» отдает два файла (шаблон приемки и номенклатуры) через эндпоинты `/orders/templates/*`; «Загрузить шаблон» открывает модальное окно загрузки заполненных шаблонов.

## 2026-01-05
- Заявка на упаковку перенесена в раздел "Заявки": отдельный шаблон `/orders/packing/`, детальная карточка заявки и логирование через аудит.
- Заявка на упаковку оформлена в стиле кабинета клиента, навигация упрощена; блоки "Клиент" и "Контакты" убраны, данные передаются скрыто.
- Кабинет клиента: ссылки на заявки ведут в раздел "Заявки"; после сохранения реквизитов клиент возвращается в свой кабинет.
- Клиенту разрешено редактировать собственные реквизиты и использовать автозаполнение по ИНН.
- Журнал клиентов: добавлен audit-журнал клиентов, логирование создания/изменения/архивирования и отдельная страница `/audit/clients/`.
- Реквизиты клиента: валидации обязательных ИНН/телефона/ФИО, форматирование телефона в `+7 (___) ___-__-__`.
- Карточка упаковки: восстановлена правая колонка, информация/комментарии разведены по двум блокам.
- Клиентский кабинет и журнал: черновики скрыты для не‑клиентов; сообщения фильтруются без черновиков.
- Черновики клиента: открываются в режиме редактирования, добавлены кнопки «Отправить менеджеру» и «Сохранить черновик», отправка меняет статус.
- Клиент без `?client=`: разрешен доступ к заявкам по связке `portal_user`.
- Названия заявок без товаров: добавлено отображение «Заявка на приемку без указания товара» в задачах/карточках/журнале.

## 2026-01-04
- Акт размещения: обновлен интерфейс (содержимое палеты в таблице, колонка SKU, убраны лишние боковые блоки), добавлена проверка закрытия только при распределении коробов по палетам.
- Акт размещения: уточнены статусы/подсказки, исправлены счетчики и логика активной палеты, добавлено резюме по товарам/коробам/палетам.
- Убраны внешние Google Fonts на акте размещения; добавлен favicon-роут для устранения лишних запросов.
- Кабинет клиента: скорректирована логика статусов/колонок заявок, добавлена подсветка актов, скрытие актов после просмотра.
- Журнал остатков клиента: исправлены фильтры по колонкам SKU/Название/Размер.
- Форма заявки на упаковку (в кабинете клиента): переработка стиля и возврат к виду заявки на приемку по итогам правок.

## 2026-01-03
- Складские остатки клиента: отдельный шаблон в стиле кабинета клиента, скрыты колонки хранения/короб/палета/дата и заявка, объединение строк по SKU+наименованию+размеру, фильтры-списки под заголовками и общий поиск с подсказками после 3 символов.
- Складские остатки менеджера: отдельный шаблон в стиле кабинета менеджера, фильтры-списки под Клиент/SKU/Наименование, проставлены «-» в строке фильтров для Даты/Короба/Палеты/Стеллажа/Ряда/Полки.
- Задачи менеджера: выполненные задачи больше не подсвечиваются.
- Складские остатки менеджера: добавлена кнопка возврата в кабинет.

## 2026-01-01
- Кабинет клиента: 3-колоночная сетка на всю ширину, отдельная колонка сообщений, независимый скролл в колонках; убраны лишние подписи и блоки.
- Кабинеты менеджера, кладовщика, главного менеджера и директора: единый стиль, сообщения справа, независимый скролл колонок задач, убраны лишние сводки.
- Доска задач: подсветка и пульсация задач текущего исполнителя, сортировка "Готово" по свежим, переходы по задачам-заявкам сразу в карточку заявки.
- Карточка задачи `/todo/<id>/`: новый 3-колоночный layout (действия слева, таблица по центру, комментарии справа), скролл таблицы, фиксированная шапка, зебра и вертикальные границы.
- Карточка заявки `/orders/receiving/<id>/`: обновленный layout, кнопка "Исправить заявку" доступна только менеджеру.
- Акт приемки: левый столбик с инфо и кнопками, скролл таблицы, подсвеченная шапка, зебра и вертикальные границы; подсветка совпадений (зеленый) и расхождений (розовый), автосохранение черновика, фактические количества пустые по умолчанию, добавлен телефон водителя.
- Акт размещения: стиль акта приемки, левый столбик с инфо/кнопками, список коробов/палет, кнопки добавления перенесены влево, убраны лишние заголовки в центре.

## 2025-12-30
- Акт приемки: отдельная форма с фактическими количествами, редактируемыми полями «Когда/Машина», добавлением позиций и отметкой «с расхождениями».
- Акт размещения: отдельный шаблон по коробам/палетам, переход после сохранения акта приемки.
- Карточка заявки: кнопки «Открыть акт приемки / с расхождениями» и «Открыть/Создать акт размещения».
- Задачи склада: кладовщик проходит акты приемки/размещения, после размещения задача кладовщика закрывается и создается задача менеджеру.
- Журнал заявок: для черновиков действие «У клиента», для склада — «У кладовщика».
- Приемка: исправлено сохранение черновика, валидации обязательных полей, логика даты/времени приемки.
- Акт размещения: список неразмещенных товаров, короба/палеты с QR, выпадающие списки номенклатуры; палета может состоять из коробов и/или товаров.
- Короба: завершение формирования и просмотр состава в списке сформированных коробов.
- Карточка задачи `/todo/<id>/`: форма просмотра как в журнале заявок, история в обратном порядке с подсветкой последней записи.
- Карточка задачи и заявки: кнопки актов приемки/размещения отображаются по факту (включая акты с расхождениями).
- Менеджер: после размещения доступна отправка акта клиенту, статус заявки переводится в «Выполнена», клиент получает сообщение.

## 2025-12-26
- Кабинет клиента: блок «Заявки» увеличен и превращен в «Панель заявок» (У клиента / У менеджера / На складе / Выполнена), удалены фейковые блоки и пояснения, добавлен отдельный блок «Сообщения».
- История заявок: записи показывают актуальный статус, чат не дублируется в историю, формат даты/времени приведен к одному виду.
- Заявки на приемку: добавлена кнопка «Исправить заявку» для менеджера с подробной записью в истории и уведомлением клиента.
- Ответственные и подписи: «Индивидуальный предприниматель» сокращено до «ИП», роль «Ответственный» заменена на «Текущий ответственный», переведен тип мест (pallet → «Паллет»).
- Задачи: стиль «Ivory Gold», карточки подписаны как «Заявка на приемку товара №…», в задаче есть «Зайти в заявку» и «Вернуться в кабинет».
- Процесс приемки: менеджер подтверждает и отправляет на склад, создается задача кладовщика и статус у клиента переводится в «На складе».
- Дедлайны приемки: до 14:00 — выполнить сегодня до 18:00, после 14:00 — завтра до 13:00.
- Склад: создано приложение `sklad` с кабинетом кладовщика на базе шаблона менеджера, все тексты переведены на русский.
- Доступы: введен единый вход `/login/`, выход `/logout/`, dev-входы скрыты в проде; привязка пользователей к сотрудникам и клиентам, запрет переходов между кабинетами ролей.
- Добавлена команда `bootstrap_logins` для генерации логинов сотрудников и клиентов, список отображается на странице входа.
- Прод: изменения задеплоены, применены миграции, сервис перезапущен.

## 2025-12-25
- Кабинет менеджера `/team-manager/`: убраны кнопки Номенклатура/Синхронизация/Задачи и нижние карточки, оставлена панель задач.
- Журнал заявок `/orders/`: обновлены колонки (Тип/Действие/Статус/Клиент), убрана колонка «Ответственный», Клиент сокращается до «ИП».
- Тип заявки: «ЗП» для заявок на поставку; Действие: «В работе у менеджера Фамилия И.О.»; Статус: «На подтверждении» или «Черновик».
- Журнал заявок: показывается одна строка на заявку по записи с актуальным статусом, история остается внутри карточки заявки.
- Задачи менеджера: при отправке заявки клиентом дедлайн задается +1 сутки от момента отправки.
- Миграции: синхронизированы изменения `todo`, применена миграция `0007_alter_task_status`.
- Прод: изменения задеплоены, gunicorn перезапущен.

## 2025-12-24
- Кабинет клиента: переведен на светлый стиль «Ivory Gold» (единая палитра, кнопки, карточки, поля ввода и таблицы) во всех шаблонах client_cabinet.
- Номенклатура клиента: карточки в 2 колонки расширены, миниатюры приведены к 30×30 мм; улучшен вид dropdown выбора клиента на login-menu.
- Печать этикеток: превью запускается из разных мест и возвращается назад; добавлен вывод размера этикетки; режим печати скрывает все кроме этикетки.
- Этикетки: добавлены кнопки «с ЧЗ / без ЧЗ», режим без ЧЗ по умолчанию в print; ограничение текста 5 словами; исправлена отрисовка превью.
- Этикетка без ЧЗ: новая компоновка (4 строки), крупные «Артикул/Наименование», отдельные строки Цвет/Состав/Поставщик, 3-я строка поделена на Страна/Р‑р, 4-я строка — штрихкод на всю ширину с цифрами.
- Этикетка с ЧЗ: добавлен «Артикул» вверху; уточнены размеры (58×40 для клиента, 35×20 для SKU).
- Маркетплейсы: добавлена синхронизация Ozon (кнопка, статус, подробные ошибки), загрузка списка товаров и характеристик.
- Прод: оставлены только 3 клиента (WB/Ozon), остальное удалено; изменения задеплоены и сервис перезапущен.
- ШК/размеры: добавлено поле размера в SKUBarcode, миграция 0007 и отображение в админке.
- WB/Ozon синхронизация: сохранение соответствия размер↔штрихкод (WB по sizes[].skus, Ozon по атрибуту размера).
- Номенклатура клиента: выпадающий список размеров, авто-выбор минимального размера, смена ШК при выборе размера, корзина учитывает размер.
- Заявки на приемку: добавлена колонка «Размер», валидация выбора размера, уменьшен шрифт ШК; сохранение черновика при переходе в номенклатуру.
- Журнал заявок: последовательная нумерация заявок, детальная карточка с историей и чатом, участники и комментарии из аудита.
- Шаблоны: добавлен общий блок «Текущий пользователь» во всех кабинетах/журналах/шаблонах клиента.

## 2025-12-23
- Этикетка SKU (35x20 мм): переработана в блоки (штрихкод слева, QR в правом верхнем блоке 2x2, инфоблок по центру), добавлена поддержка переносов строк и приоритетных полей (наименование/размер/бренд), скрытие бренда при значении Nobrand.
- Этикетка SKU: добавлен EAC из изображения `eac1.png`, уменьшен и закреплен в правом нижнем углу.
- Номенклатура клиента: добавлена иконка печати этикетки в списке, автопоказ превью при `?print=1`.
- Маркетплейсы: создано приложение `market_sync`, добавлен дашборд `/market-sync/` со статусами настройки (красный/желтый/зеленый) и кнопками настройки.
- WB синхронизация: страница `/market-sync/wb/`, форма токена, кнопка «Синхронизировать», блок прогресса/результатов/ошибок; бекенд синхронизирует номенклатуру WB и обновляет SKU/штрихкоды/бренд/цвет/размер.
- Ozon настройки: страница `/market-sync/ozon/`, форма Client ID и API ключа; статус на дашборде учитывает заполненность ключей.

## 2025-12-22
- Задачи: роли постановщик/исполнитель/наблюдатель, видимость задач для всех трёх; редактирование только постановщиком; исполнитель отмечает выполнено, постановщик возвращает на доработку с комментарием; детальная карточка задачи с комментариями и файлами; панель задач добавлена во все кабинеты, включая кабинет главного менеджера.
- Канбан задач: колонки по срокам (Просрочены/Сегодня/Скоро), обязательный дедлайн с дефолтом "завтра", убраны поля маршрут/статус из формы создания.
- Медиа: подключены MEDIA_URL/MEDIA_ROOT и раздача файлов через nginx для вложений задач.
- Кабинеты/вход: активированы серые кнопки на login-menu, добавлен кабинет главного менеджера с блоком задач.
- Заявки: форма приемки (A2.2) перенесена в раздел "Заявки" `/orders/receiving/` с выбором клиента, таблицей состава поставки, документами и комментариями; маршрут из клиентского кабинета ведёт в заявки.
- Кабинет директора: добавлены кнопки "Описание проекта" и "Журнал разработки".

## 2025-12-19
- SKU: добавлены стрелки сортировки в заголовках, серверная сортировка; выпадающие фильтры по ключевым полям; живые подсказки поиска; сохранение состояния между таблицей и карточками; вертикальные границы ячеек.
- Залито на сервер (шаблоны/вью), пуш в GitHub `git@github.com:vlas47/fullbox.git` (ветка main) с действующим ключом `~/.ssh/id_ed25519`.
- Создано приложение `audit` (аудит и процессы), добавлено в INSTALLED_APPS.

## 2025-12-21
- Добавлено приложение `client_cabinet`: список клиентов (табличный/карточный режимы, фильтры, архив/актив), формы создания/редактирования с автоподстановкой реквизитов по ИНН (DaData), копирование/архивация. В меню быстрого входа отдельный блок ЛК клиента с выбором клиента; кнопка на дев-странице ведет на список.
- Клиентская номенклатура: отдельные шаблоны списка и формы, вывод только SKU выбранного клиента, действия (создать/редактировать/копия/удалить) возвращают в контур клиента, скрыт столбец клиента при фильтре. Кнопка в кабинете ведет на клиентский список.
- Форма заявки на приемку в кабинете клиента (черновик): плановая дата/время, таблица позиций с выбором SKU из номенклатуры клиента, автоподстановка названия и ШК, количества, комментарии, ожидаемое число коробов, загрузка файлов, общий комментарий. Добавлена кнопка «Заявка на приемку» в кабинете.
- Инфраструктура: настроены маршруты `client/<id>/sku/*`, `client/<id>/orders/new/`, `client/<id>/receiving/new/`; миграция `0006` для поля `archived` в клиентах; установлен `requests` для DaData; перезапуски runserver и заливка на прод.
- Журнал заявок: добавлена модель `OrderAuditEntry`, просмотр `/audit/orders/`, логирование действий приемки/упаковки. Отдельная форма заявки на упаковку (`client/<id>/packing/new/`) с полями по анкете (маркетплейсы, объем, маркировка, упаковка, файлы) и логированием в аудит. Добавлен тест сканера `/scanner-test/` (в т.ч. WebHID), кнопка проверки сканера в дев-кабинете.

## 2025-12-17
- Создано виртуальное окружение `.venv` и установлен Django 6.0.
- Сгенерирован SSH-ключ `~/.ssh/fullbox_root` для доступа к серверу.
- Добавлен публичный ключ в `~/.ssh/authorized_keys` на `root@95.163.227.182`.
- Проверено подключение к серверу по ключу.
- На сервере создана папка `/opt/fullbox`, развернут проект и зависимости установлены в `/opt/fullbox/.venv`.
- Выполнены миграции на сервере (`/opt/fullbox/fullbox/manage.py migrate`).
- Сервер очищен и подготовлен: установлены пакеты (python3-venv, pip, curl, PostgreSQL 16, libpq-dev).
- Созданы роль и база PostgreSQL (`fullbox`/`fullbox`, пароль `fullbox_db_pass`).
- На сервере развернута обновлённая версия проекта в `/opt/fullbox` с зависимостями из `requirements.txt` (psycopg добавлен).
- Применены миграции с подключением к PostgreSQL через переменные окружения `.env`.
- Запущена тестовая страница через `runserver` и проверена доступность (`curl http://127.0.0.1:8000/`).
- Добавлены переменные окружения для домена `kondelyabr.ru` (`ALLOWED_HOSTS`) и отключён DEBUG в `.env`; проверка `https://kondelyabr.ru/` возвращает страницу без ошибки DisallowedHost.
- Создано приложение `sku`: модели SKU, штрихкоды, фото, привязки к маркетплейсам; админ-интерфейс.
- Добавлена страница списка SKU `/sku/` (поиск по артикулу/названию/ШК).
- Миграции `sku` применены на сервере; `runserver` перезапущен.
- Добавлена главная страница (landing) с промо услуг фулфилмента в стиле Lamborghini; маршрут '/' подключён.
- Создано приложение `orders` с вкладками (Журнал, Приемка, Обработка, Отгрузка, Прочее, На главную); страница `/orders/` по умолчанию показывает Журнал.
- Создано приложение `employees` с ролью выбора (администратор, директор, бухгалтер, главный менеджер, менеджер, кладовщик, сборщик); модель зарегистрирована в админке.
- Миграция employees применена на сервере, runserver перезапущен.
- В роли сотрудников добавлен 'Разработчик'; миграция employees применена на сервере, сервис перезапущен.
- Добавлен dev login-menu `/login-menu/` (стиль Lamborghini) с кнопками для быстрого входа пользователями ролей; маршруты `login-menu` и `dev-login/<username>/` настроены.
- Панель разработчика вынесена в отдельную страницу `/dev/`; блок убран с главной. Быстрые ссылки: dev вход, SKU, заявки, сотрудники, админка.
- Добавлены кабинеты для ролей: /cabinet/<role>/ (директор, бухгалтер, главный менеджер, менеджер, кладовщик, сборщик, разработчик и др.); dev-login перенаправляет на нужный кабинет, админ — в /admin/, developer — в /dev/.
- Обновлена страница SKU `/sku/` в стиле сайта: переключатель Таблица/Карточки, сохранение поиска, карточный вид с ВГХ/ШК/фото.
- Кнопка 'Главный менеджер' в dev login теперь активна и ведёт через dev-login в кабинет главного менеджера (/head-manager/); изменения задеплоены на сервер, runserver перезапущен.
- Создано приложение \	odo\ (Задачи): список/создание/редактирование/удаление с полями статус/приоритет/дедлайн, ссылка добавлена в кабинет разработчика; миграции применены на сервере, runserver перезапущен.
в 

