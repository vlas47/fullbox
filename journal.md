# Журнал работ

## 2025-12-23
- Этикетка SKU (35x20 мм): переработана в блоки (штрихкод слева, QR в правом верхнем блоке 2x2, инфоблок по центру), добавлена поддержка переносов строк и приоритетных полей (наименование/размер/бренд), скрытие бренда при значении Nobrand.
- Этикетка SKU: добавлен EAC из изображения `eac1.png`, уменьшен и закреплен в правом нижнем углу.
- Номенклатура клиента: добавлена иконка печати этикетки в списке, автопоказ превью при `?print=1`.

## 2025-12-22
- Задачи: роли постановщик/исполнитель/наблюдатель, видимость задач для всех трёх; редактирование только постановщиком; исполнитель отмечает выполнено, постановщик возвращает на доработку с комментарием; детальная карточка задачи с комментариями и файлами; панель задач добавлена во все кабинеты, включая кабинет главного менеджера.
- Канбан задач: колонки по срокам (Просрочены/Сегодня/Скоро), обязательный дедлайн с дефолтом "завтра", убраны поля маршрут/статус из формы создания.
- Медиа: подключены MEDIA_URL/MEDIA_ROOT и раздача файлов через nginx для вложений задач.
- Кабинеты/вход: активированы серые кнопки на login-menu, добавлен кабинет главного менеджера с блоком задач.
- Заявки: форма приемки (A2.2) перенесена в раздел "Заявки" `/orders/receiving/` с выбором клиента, таблицей состава поставки, документами и комментариями; маршрут из клиентского кабинета ведёт в заявки.
- Кабинет директора: добавлены кнопки "Описание проекта" и "Журнал разработки".

## 2025-12-19
- SKU: добавлены стрелки сортировки в заголовках, серверная сортировка; выпадающие фильтры по ключевым полям; живые подсказки поиска; сохранение состояния между таблицей и карточками; вертикальные границы ячеек.
- Залито на сервер (шаблоны/вью), пуш в GitHub `git@github.com:vlas47/fullbox.git` (ветка main) с действующим ключом `~/.ssh/id_ed25519`.
- Создано приложение `audit` (аудит и процессы), добавлено в INSTALLED_APPS.

## 2025-12-21
- Добавлено приложение `client_cabinet`: список клиентов (табличный/карточный режимы, фильтры, архив/актив), формы создания/редактирования с автоподстановкой реквизитов по ИНН (DaData), копирование/архивация. В меню быстрого входа отдельный блок ЛК клиента с выбором клиента; кнопка на дев-странице ведет на список.
- Клиентская номенклатура: отдельные шаблоны списка и формы, вывод только SKU выбранного клиента, действия (создать/редактировать/копия/удалить) возвращают в контур клиента, скрыт столбец клиента при фильтре. Кнопка в кабинете ведет на клиентский список.
- Форма заявки на приемку в кабинете клиента (черновик): плановая дата/время, таблица позиций с выбором SKU из номенклатуры клиента, автоподстановка названия и ШК, количества, комментарии, ожидаемое число коробов, загрузка файлов, общий комментарий. Добавлена кнопка «Заявка на приемку» в кабинете.
- Инфраструктура: настроены маршруты `client/<id>/sku/*`, `client/<id>/orders/new/`, `client/<id>/receiving/new/`; миграция `0006` для поля `archived` в клиентах; установлен `requests` для DaData; перезапуски runserver и заливка на прод.
- Журнал заявок: добавлена модель `OrderAuditEntry`, просмотр `/audit/orders/`, логирование действий приемки/упаковки. Отдельная форма заявки на упаковку (`client/<id>/packing/new/`) с полями по анкете (маркетплейсы, объем, маркировка, упаковка, файлы) и логированием в аудит. Добавлен тест сканера `/scanner-test/` (в т.ч. WebHID), кнопка проверки сканера в дев-кабинете.

## 2025-12-17
- Создано виртуальное окружение `.venv` и установлен Django 6.0.
- Сгенерирован SSH-ключ `~/.ssh/fullbox_root` для доступа к серверу.
- Добавлен публичный ключ в `~/.ssh/authorized_keys` на `root@95.163.227.182`.
- Проверено подключение к серверу по ключу.
- На сервере создана папка `/opt/fullbox`, развернут проект и зависимости установлены в `/opt/fullbox/.venv`.
- Выполнены миграции на сервере (`/opt/fullbox/fullbox/manage.py migrate`).
- Сервер очищен и подготовлен: установлены пакеты (python3-venv, pip, curl, PostgreSQL 16, libpq-dev).
- Созданы роль и база PostgreSQL (`fullbox`/`fullbox`, пароль `fullbox_db_pass`).
- На сервере развернута обновлённая версия проекта в `/opt/fullbox` с зависимостями из `requirements.txt` (psycopg добавлен).
- Применены миграции с подключением к PostgreSQL через переменные окружения `.env`.
- Запущена тестовая страница через `runserver` и проверена доступность (`curl http://127.0.0.1:8000/`).
- Добавлены переменные окружения для домена `kondelyabr.ru` (`ALLOWED_HOSTS`) и отключён DEBUG в `.env`; проверка `https://kondelyabr.ru/` возвращает страницу без ошибки DisallowedHost.
- Создано приложение `sku`: модели SKU, штрихкоды, фото, привязки к маркетплейсам; админ-интерфейс.
- Добавлена страница списка SKU `/sku/` (поиск по артикулу/названию/ШК).
- Миграции `sku` применены на сервере; `runserver` перезапущен.
- Добавлена главная страница (landing) с промо услуг фулфилмента в стиле Lamborghini; маршрут '/' подключён.
- Создано приложение `orders` с вкладками (Журнал, Приемка, Обработка, Отгрузка, Прочее, На главную); страница `/orders/` по умолчанию показывает Журнал.
- Создано приложение `employees` с ролью выбора (администратор, директор, бухгалтер, главный менеджер, менеджер, кладовщик, сборщик); модель зарегистрирована в админке.
- Миграция employees применена на сервере, runserver перезапущен.
- В роли сотрудников добавлен 'Разработчик'; миграция employees применена на сервере, сервис перезапущен.
- Добавлен dev login-menu `/login-menu/` (стиль Lamborghini) с кнопками для быстрого входа пользователями ролей; маршруты `login-menu` и `dev-login/<username>/` настроены.
- Панель разработчика вынесена в отдельную страницу `/dev/`; блок убран с главной. Быстрые ссылки: dev вход, SKU, заявки, сотрудники, админка.
- Добавлены кабинеты для ролей: /cabinet/<role>/ (директор, бухгалтер, главный менеджер, менеджер, кладовщик, сборщик, разработчик и др.); dev-login перенаправляет на нужный кабинет, админ — в /admin/, developer — в /dev/.
- Обновлена страница SKU `/sku/` в стиле сайта: переключатель Таблица/Карточки, сохранение поиска, карточный вид с ВГХ/ШК/фото.
- Кнопка 'Главный менеджер' в dev login теперь активна и ведёт через dev-login в кабинет главного менеджера (/head-manager/); изменения задеплоены на сервер, runserver перезапущен.
- Создано приложение \	odo\ (Задачи): список/создание/редактирование/удаление с полями статус/приоритет/дедлайн, ссылка добавлена в кабинет разработчика; миграции применены на сервере, runserver перезапущен.
